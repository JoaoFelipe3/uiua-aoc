Dedup ← ⊕⍜°≡⊟⊓⊢/+⊛⊸≡⊢

Input ← ⊃(⊢⊚=@S⊢|=@^) &rl∘ &fo"input"

Part₁ ← ◌ ∧(
  ⊃(◴ /◇⊂ ⍚⨬(¤|⊟⊃-₁+₁)
  | +/+ ⊙◌
  )⊸∊⊚
) ˜⊙¤ ⊙⊙0

Part₂ ← /+≡⊣ ˜∧(
  Dedup /◇⊂ ⍚⨬(¤|⊟⊃⍜⊢-₁⍜⊢+₁)⊸(∊⊙≡⊢)⊚
) ¤˜⊟1

$Part₁ Part₁ Input
$Part₂ Part₂ Input
