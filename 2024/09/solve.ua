# Experimental!
Input ← &fras "input"

Parse ← /◇⊂⍚(↯⋕:⨬÷₂¯1◿2.) °⊏

Part₁ ← /+×°⊏ ↘: ⍜▽◌ ⊙⊙(:¯⟜↙/+⊙⇌⊃¬▽) ◡¬⊸≠¯1 Parse

Part₂ ← (
  # I seriously don't know what I'm doing anymore
  °▽⇌ Parse
  ⊙⊙0
  ⍢(∩°⊂ ⊸⊃∩⌟𝄈↘∩⌟𝄈↙
    ⨬(×⊃⊓≥⋅=₋₁⊓⊙:∘
      ⍣(⍜⊙⊙∩⌞⊏⍜⊙:⊓⟜(⊟⤚-)⤙𝄈⊟ ⊙:: ⊣⊚|⊙⊙⊙:◌)
    | ⊙∩:
    )=¯1⤙⊙⊙∘
    ⊙⊙+₁∩𝄈⊂⊙:∩⊂⊙∩:
  | ≠⧻◌
  )
  ⇌▽⊙⊙◌
  /+×∩⌞▽≠¯1,°⊏
)

⊃Part₁ Part₂ Input
