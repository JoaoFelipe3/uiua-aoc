# Experimental!
Input ← &fras "input"

Parse ← ⊜(□ ⊓(⊜⋕⊸≠@ )⋕: °$"_: _")¬⊸∈"\r\n"

Part₁ ← (
  Parse
  ≡◇(×⊸∈ ≡(∧⨬+×⊙:⊙°⊂) ⋯⇡⌝ₙ2-1⧻⟜¤)
  /+
)

Part₂ ← (
  Parse
  ≡◇(×⊸∈ ≡(∧⨬(+|×|⍜∩°⋕⊂:) ⊙:⊙°⊂) base3⇡⌝ₙ3-1⧻⟜¤)
  /+
)

Part₂ Input
